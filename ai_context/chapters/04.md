Let me continue with Chapter IV - How to Play:

Chapter IV - How to Play ER Diagram mermaid Copy Code erDiagram characters { string character_id PK string name number health_points number stamina_points number mana_points number action_points enum current_rank number sub_rank boolean is_conscious boolean is_alive }

combat_encounters {
    string encounter_id PK
    string location_id FK
    number round_number
    enum encounter_status
    number total_participants
    datetime start_time
    datetime end_time
}

combat_participants {
    string participant_id PK
    string encounter_id FK
    string character_id FK
    enum participant_type
    number initiative_order
    boolean is_active
    number current_hp
    number current_stamina
    number current_mana
}

combat_actions {
    string action_id PK
    string encounter_id FK
    string participant_id FK
    number round_number
    number action_sequence
    enum action_type
    string target_id FK
    number action_points_cost
    number stamina_cost
    number mana_cost
    string description
    boolean is_trigger_action
    string trigger_condition
}

attack_rolls {
    string roll_id PK
    string action_id FK
    number dice_rolled
    number target_number
    boolean hit_success
    number damage_dealt
    enum damage_type
    string weapon_or_spell_used
}

defensive_actions {
    string defense_id PK
    string action_id FK
    string defending_participant_id FK
    enum defense_type
    number dice_rolled
    boolean defense_success
    number damage_reduced
}

status_effects {
    string effect_id PK
    string participant_id FK
    string effect_name
    enum effect_type
    number duration_rounds
    number intensity
    string description
    boolean is_active
}

combat_encounters ||--o{ combat_participants : "includes"
combat_participants ||--o{ combat_actions : "performs"
combat_actions ||--o{ attack_rolls : "results_in"
combat_actions ||--o{ defensive_actions : "triggers"
combat_participants ||--o{ status_effects : "affected_by"
characters ||--o{ combat_participants : "participates_as"
Gameplay Flowchart mermaid Copy Code flowchart TD A[Combat Initiated] --> B[Roll Initiative/Determine Order] B --> C[Start Round] C --> D[Player Phase Begins] D --> E[Player Declares Actions] E --> F{Has Action Points?} F -->|Yes| G[Choose Action Type] F -->|No| H[End Player Phase] G --> I{Action Type?} I -->|Attack| J[Roll Attack Dice] I -->|Move| K[Move to New Position] I -->|Cast Spell| L[Check Mana Cost] I -->|Block/Dodge| M[Set Defensive Stance] I -->|Trigger Action| N[Set Trigger Condition] J --> O{Hit Target Number?} O -->|Yes| P[Deal Damage] O -->|No| Q[Attack Misses] L --> R{Sufficient Mana?} R -->|Yes| S[Cast Spell Successfully] R -->|No| T{Use HP for Mana?} T -->|Yes| U[Sacrifice HP for Mana] T -->|No| V[Spell Fails] U --> S S --> W[Apply Spell Effects] P --> X[Reduce Target HP] K --> Y[Update Position] M --> Z[Prepare Defense] N --> AA[Store Trigger] Q --> BB[Continue Actions] W --> BB X --> CC{Target HP <= 0?} CC -->|Yes| DD[Target Unconscious/Dead] CC -->|No| BB Y --> BB Z --> BB AA --> BB V --> BB BB --> F H --> EE[Enemy Phase Begins] EE --> FF[Enemies Attack Automatically] FF --> GG[Players Roll Defense] GG --> HH{Defense Successful?} HH -->|Yes| II[Reduce/Negate Damage] HH -->|No| JJ[Take Full Damage] II --> KK[Check Trigger Actions] JJ --> LL{Player HP <= 0?} LL -->|Yes| MM[Player Unconscious] LL -->|No| KK KK --> NN{Triggers Activated?} NN -->|Yes| OO[Execute Trigger Actions] NN -->|No| PP[End Round] OO --> PP PP --> QQ{Combat Continues?} QQ -->|Yes| RR[Increment Round] QQ -->|No| SS[Combat Ends] RR --> C MM --> TT{Below -HP Threshold?} TT -->|Yes| UU[Character Dies] TT -->|No| VV[Character Unconscious] DD --> QQ UU --> SS VV --> QQ SS --> WW[Resolve Combat Results] TypeScript Enums & Constants typescript Copy Code enum ActionType { ATTACK = "attack", MOVE = "move", CAST_SPELL = "cast_spell", BLOCK = "block", DODGE = "dodge", FLEE = "flee", USE_ITEM = "use_item", TRADE = "trade", TRIGGER_ACTION = "trigger_action", CLIMB = "climb", OPEN_DOOR = "open_door" }

enum DefenseType { BLOCK = "block", DODGE = "dodge", PARRY = "parry", MAGICAL_RESISTANCE = "magical_resistance" }

enum EncounterStatus { INITIATED = "initiated", IN_PROGRESS = "in_progress", PLAYER_VICTORY = "player_victory", PLAYER_DEFEAT = "player_defeat", FLED = "fled", DRAW = "draw" }

enum ParticipantType { PLAYER_CHARACTER = "player_character", ENEMY_MONSTER = "enemy_monster", ALLY_NPC = "ally_npc", NEUTRAL = "neutral" }

enum DamageType { PHYSICAL = "physical", MAGICAL = "magical", FIRE = "fire", ICE = "ice", LIGHTNING = "lightning", POISON = "poison", NECROTIC = "necrotic", HOLY = "holy" }

enum StatusEffectType { BUFF = "buff", DEBUFF = "debuff", DOT = "damage_over_time", HOT = "heal_over_time", STUN = "stun", PARALYSIS = "paralysis", CHARM = "charm", FEAR = "fear" }

const STARTING_STATS = { HEALTH_POINTS: 3, STAMINA_POINTS: 3, MANA_POINTS: 10, ACTION_POINTS: 3 } as const;

const COMBAT_MECHANICS = { ROUND_DURATION_SECONDS: 6, ACTION_DURATION_SECONDS: 2, HIT_TARGET_NUMBER: 5, DICE_SIDES: 6, DEATH_THRESHOLD_MULTIPLIER: -1, EXTRA_MOVEMENT_STAMINA_COST: 1, FLEE_ACTION_COST: 1 } as const;

const BRONZE_RANK_CHANGES = { USE_TIME_SYSTEM: true, BASE_CAST_TIMES: { LOW_INTENSITY: 1, MEDIUM_INTENSITY: 2, HIGH_INTENSITY: 3, EXTREME_INTENSITY: 4 }, TIME_REDUCTION_FORMULA: "i * (1 - L/75)" // i = base time, L = (main_level * 10) + sub_level } as const; Explanatory Notes • Combat uses simultaneous phases - players act first, then enemies respond automatically • Each character starts with 3 HP, 3 Stamina, 10 Mana, and 3 Action Points per round • Players must roll to hit (5+ on d6), enemies hit automatically but players can defend • Each action takes 1 Action Point and roughly 2 seconds of in-game time • Characters can sacrifice HP for mana in dire situations (1:1 ratio) • Trigger actions allow setting conditional responses that activate during enemy phase • At Bronze rank, the system transitions from Action Points to time-based casting • Fleeing requires avoiding attacks from all enemies in your zone • Death occurs when HP drops significantly below 0, unconsciousness at 0 HP • Movement between zones costs extra stamina when no enemies are present